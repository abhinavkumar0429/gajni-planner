<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            background-color: #2e2a4a; 
            font-family: "Times New Roman", Times, serif;
            color: #FFFFFF;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;    
            padding-top: 80px;
            min-height: 100vh;
        }

        .top-nav { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000; }
        .btn {
            color: #da70d6; text-decoration: none; font-weight: bold;
            padding: 8px 15px; border: 2px solid #da70d6; 
            border-radius: 30px; font-size: 13px; transition: 0.3s;
            background: rgba(46, 42, 74, 0.9); cursor: pointer;
        }
        .btn:hover { background-color: #da70d6; color: white; box-shadow: 0 0 15px #da70d6; }

        #back-live-btn { border-color: #00ffcc; color: #00ffcc; display: none; }
        #back-live-btn:hover { background-color: #00ffcc; color: #2e2a4a; box-shadow: 0 0 15px #00ffcc; }

        .daily-container { width: 90%; max-width: 600px; margin-bottom: 40px; }
        .checklist-box { 
            background: rgba(255, 255, 255, 0.05); 
            border: 2px solid #da70d6; 
            border-radius: 15px; 
            padding: 20px;
        }

        .input-area {
            width: 100%; padding: 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid #da70d6;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            outline: none;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        .task-item {
            display: flex; align-items: center; gap: 10px;
            margin-bottom: 10px; padding: 8px;
            background: rgba(218, 112, 214, 0.1); border-radius: 8px;
        }

        input[type="checkbox"] { accent-color: #da70d6; width: 18px; height: 18px; cursor: pointer; }
        .task-text { flex-grow: 1; font-size: 18px; }
        .completed { text-decoration: line-through; color: #888; }
        .delete-task { background: transparent; border: none; color: #ff4d4d; cursor: pointer; font-size: 18px; }

        /* History Tags with Delete */
        #history-section { width: 90%; max-width: 600px; border-top: 1px solid #da70d6; padding-top: 20px; text-align: center; }
        .history-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 15px; }
        
        .history-item { 
            display: flex; align-items: center; 
            background: rgba(218, 112, 214, 0.2); border-radius: 15px; 
            overflow: hidden; border: 1px solid transparent; transition: 0.3s;
        }
        .history-text { padding: 5px 12px; cursor: pointer; font-size: 13px; }
        .delete-single-hist { 
            background: rgba(255, 0, 0, 0.3); color: white; padding: 5px 10px; 
            cursor: pointer; border: none; font-weight: bold;
        }
        .delete-single-hist:hover { background: red; }

        .clear-all-btn { 
            margin-top: 20px; color: #ff4d4d; border: 1px solid #ff4d4d; 
            background: transparent; padding: 5px 15px; border-radius: 20px; 
            cursor: pointer; font-size: 12px; 
        }
        .clear-all-btn:hover { background: #ff4d4d; color: white; }
        
        .status-msg { color: #da70d6; font-style: italic; margin-bottom: 10px; height: 20px; }
    </style>
</head>
<body>

    <div class="top-nav">
        <button id="back-live-btn" class="btn" onclick="loadCurrent()">← Back to Today</button>
        <button class="btn" onclick="archiveDay()">Archive & New Day</button>
        <a href="WP.html" class="btn">Weekly</a>
        <a href="ALERT.html" class="btn">Home</a>
    </div>

    <h1>Daily Checklist</h1>
    <div id="status" class="status-msg">Today's List</div>

    <div class="daily-container">
        <div class="checklist-box">
            <input type="text" id="task-input" class="input-area" placeholder="Type task & press Enter...">
            <div id="task-list"></div>
        </div>
    </div>

    <div id="history-section">
        <h3>Past Days</h3>
        <div id="history-list" class="history-container"></div>
        <button class="clear-all-btn" onclick="clearAllHistory()">Wipe All History</button>
    </div>

    <script>
        const input = document.getElementById('task-input');
        const list = document.getElementById('task-list');
        const status = document.getElementById('status');
        const backBtn = document.getElementById('back-live-btn');
        let isViewingHistory = false;

        input.addEventListener('keypress', function (e) {
            if (e.key === 'Enter' && input.value.trim() !== "") {
                addTask(input.value, false);
                input.value = "";
                saveCurrent();
            }
        });

        function addTask(text, isDone) {
            const div = document.createElement('div');
            div.className = 'task-item';
            div.innerHTML = `
                <input type="checkbox" ${isDone ? 'checked' : ''} onchange="toggleTask(this)" ${isViewingHistory ? 'disabled' : ''}>
                <span class="task-text ${isDone ? 'completed' : ''}">${text}</span>
                ${!isViewingHistory ? `<button class="delete-task" onclick="this.parentElement.remove(); saveCurrent();">×</button>` : ''}
            `;
            list.appendChild(div);
        }

        function toggleTask(checkbox) {
            const text = checkbox.nextElementSibling;
            checkbox.checked ? text.classList.add('completed') : text.classList.remove('completed');
            saveCurrent();
        }

        function saveCurrent() {
            if (isViewingHistory) return;
            const tasks = [];
            document.querySelectorAll('.task-item').forEach(item => {
                tasks.push({ text: item.querySelector('.task-text').innerText, done: item.querySelector('input').checked });
            });
            localStorage.setItem('gajni_daily_tasks', JSON.stringify(tasks));
        }

        function loadCurrent() {
            isViewingHistory = false;
            backBtn.style.display = 'none';
            input.style.display = 'block';
            status.innerText = "Today's List";
            status.style.color = "#da70d6";
            const saved = JSON.parse(localStorage.getItem('gajni_daily_tasks')) || [];
            list.innerHTML = '';
            saved.forEach(t => addTask(t.text, t.done));
            renderHistory();
        }

        function archiveDay() {
            const tasks = JSON.parse(localStorage.getItem('gajni_daily_tasks')) || [];
            if (tasks.length === 0) return alert("Nothing to archive!");
            const history = JSON.parse(localStorage.getItem('gajni_daily_hist')) || [];
            history.push({ date: new Date().toLocaleString(), data: tasks });
            localStorage.setItem('gajni_daily_hist', JSON.stringify(history));
            localStorage.setItem('gajni_daily_tasks', JSON.stringify([]));
            loadCurrent();
        }

        function renderHistory() {
            const history = JSON.parse(localStorage.getItem('gajni_daily_hist')) || [];
            const histList = document.getElementById('history-list');
            histList.innerHTML = '';
            history.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div class="history-text" onclick='showHistory(${JSON.stringify(item)})'>${item.date}</div>
                    <button class="delete-single-hist" onclick="deleteHistoryItem(${index})">×</button>
                `;
                histList.appendChild(div);
            });
        }

        function showHistory(item) {
            isViewingHistory = true;
            backBtn.style.display = 'block';
            input.style.display = 'none';
            status.innerText = "Viewing History: " + item.date;
            status.style.color = "#00ffcc";
            list.innerHTML = '';
            item.data.forEach(t => addTask(t.text, t.done));
        }

        function deleteHistoryItem(index) {
            if(confirm("Delete this day's history permanently?")) {
                let history = JSON.parse(localStorage.getItem('gajni_daily_hist')) || [];
                history.splice(index, 1);
                localStorage.setItem('gajni_daily_hist', JSON.stringify(history));
                renderHistory();
            }
        }

        function clearAllHistory() {
            if(confirm("Delete ALL daily history? This cannot be undone.")) {
                localStorage.removeItem('gajni_daily_hist');
                renderHistory();
            }
        }

        loadCurrent();
    </script>
</body>
</html>